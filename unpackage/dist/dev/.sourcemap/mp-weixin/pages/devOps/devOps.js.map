{"version":3,"sources":["webpack:///E:/code/swms-app/pages/devOps/devOps.vue?5952","webpack:///E:/code/swms-app/pages/devOps/devOps.vue?5e1e","uni-app:///main.js","webpack:///E:/code/swms-app/pages/devOps/devOps.vue?1be3","webpack:///E:/code/swms-app/pages/devOps/devOps.vue?b0d4","webpack:///E:/code/swms-app/pages/devOps/devOps.vue?02b9","webpack:///E:/code/swms-app/pages/devOps/devOps.vue?8c1e","uni-app:///pages/devOps/devOps.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","HeaderTabBar","SlidingBreadcrumbs","Footer","DialogTips","DeviceImage","data","tabbarId","organs","devices","selectOrgans","organId","organName","parentId","showType","file_url","deviceId","installPicture","apiUrl","options","searchValue","currentCount","deviceTypeId","computed","isTokenValid","onLoad","console","onBackPress","length","isback","id","methods","tabbarToggle","getOrganTree","uni","mask","title","res","resolve","reject","getDevice","showDevice","handleGrouping","name","children","deviceDefend","childrens","getOrgansId","type","organType","getChildren","result","onPopupPhotograph","count","sizeType","sourceType","success","fail","selectGalleryPick","plus","filter","multiple","maximum","onPhotoUpload","item","onDeviceDefend","keyword","onPhotoPreview","onUnfold","openDeleteDialog","index","dialogConfirm","onDeletePhoto","onAddPhoto","onClose","search","input","blur","clear","focus","touchStart","touchEnd"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAq6C,CAAgB,s3CAAG,EAAC,C;;;;;;;;;;;ACAz7C;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;;;;ACNL;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmH;AACnH;AAC0D;AACL;AACc;;;AAGnE;AACkM;AAClM,gBAAgB,4MAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,iFAAM;AACR,EAAE,0FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,mWAEN;AACP,KAAK;AACL;AACA,aAAa,sTAEN;AACP,KAAK;AACL;AACA,aAAa,gQAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAA8vB,CAAgB,2wBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACwFlxB;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eACA;EACAC;IACAC;IACAC;IACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC,4BACA;IACAC;EACA,GACA;EACAC;IACA;MACA;MACAC;MACA;IACA;EACA;EACAC;IACA;MACA;QACAC;QACAC;MACA;QACAA;MACA;QACAC;MACA;QACAA;MACA;MACA;MACA;MACA;IACA;EACA;EACAC;IACA;AACA;AACA;AACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MAAA;MACAC;QACAC;QACAC;MACA;MACAV;MACA;QACA;UACAb;QACA;UACA,IACAP,OACA+B,SADA/B;UAEAoB;UACA;UACA;UACA;UACA;UACAY;UAEAJ;QACA;UACAR;UACAa;UACAL;UACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;AACA;IACAM;MAAA;MACAN;QACAC;QACAC;MACA;MACA;QACA;UACA;UACA,IACA9B,OACA+B,IADA/B;UAEA;YACAoB;YACA;cACA;cACA;YACA;cACA;cACA;YACA;YACAY;UACA;YACA;YACAA;UACA;UACAJ;QACA;UACAR;UACAa;UACAL;UACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAO;MAAA;MACA;MACA;QACA;UACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MAAA;MACA;MACApC;QACA,+BACA;UAAA;QAAA,EACA;QACA;UACA;YAAA;UAAA;UACA;YACAwB;YACAR;YACAqB;YACAC;YACAnC;YACAoC;YACAC;UACA;QACA;UACA;YAAA;UAAA;UACA;YACA;cAAA;YAAA;YACA;cACAhB;cACAR;cACAqB;cACAC;cACAnC;cACAoC;cACAC;YACA;UACA;QACA;MACA;MACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MACA;MACA;QAAA;MAAA;MACA;QAAA;MAAA;MACA;MACA;QACA;QACA;UACA;YACAC;YACArC;YACAsC;UACA;UACA;QACA;UACA;QACA;MACA;QACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,MAEA5C;kBAAA;kBAAA;gBAAA;gBACA;gBACA;gBACA;kBACA;kBACA;kBACA;kBACA;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAEA;gBACA6C;gBAAA,MACA7C;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBAAA6C;gBAAA;gBAAA;cAAA;gBAEAhC;kBACA6B;kBACArC;kBACAsC;gBACA;gBACA;gBAAA;gBAAA,OACA;cAAA;gBAAAE;cAAA;gBAEA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACA;AACA;AACA;AACA;IACAC;MAAA;MACA;MACAlB;QACAmB;QACAC;QAAA;QACAC;QAAA;QACAC;UACA;UACA;QACA;QACAC;UACA/B;QACA;MACA;IACA;IACA;AACA;AACA;IACAgC;MAAA;MACAC;QACA;MACA;QACAjC;MACA;QACAkC;QACAC;QACAC;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA7B;kBACAC;kBACAC;gBACA;gBACAjB;kBACA;kBACA;gBACA;gBACA;kBACA,8BACA;oBACAA;sBACA;sBACA;oBACA;kBACA;gBACA;gBAAA,uCACAb;gBAAA;gBAAA;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBAAA0D;gBAAA;gBAAA,OACA;cAAA;gBAAAb;gBACA;kBACAhC;oBACA,sCACA,sBACA;oBACA;kBACA;gBACA;kBACAO;gBACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA,OAEA;cAAA;gBACAQ;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;AACA;AACA;AACA;IACA+B;MAAA;MACAvC;MACA;QACA;UACA,IACApB,OACA+B,IADA/B;UAEA;YACA;cACA0C;cACArC;cACAsC;cACAiB;YACA;YACA;YACA5B;UACA;YACA;YACAA;UACA;QACA;UACAZ;UACAa;UACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;IACA4B;MAAA;MACA;QAAA;MAAA;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MACA;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;IACAC;MACA;QACAvC;QACAxB;QACAgE;MACA;MACA;MACA;IACA;IACA;AACA;AACA;IACAC;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACArD;kBACA;kBACA;gBACA;gBACAb;gBACAA;kBACAa;oBACA;oBACA;kBACA;gBACA;gBAAA;gBAAA,OACA;cAAA;gBAAAkB;gBACA;kBACA;gBACA;gBACAX;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;AACA;AACA;AACA;AACA;IACA+C;MACA/C;MACA;MACA;MACA;MACA;IACA;IACA;AACA;AACA;IACAgD;MACA;IACA;IACA;AACA;AACA;AACA;IACAC;MACA;MACA;QACA3B;QACA;QACA;QACAkB;MACA;MACA;IACA;IACA;AACA;AACA;AACA;IACAU;MACA;QACA;UACA5B;UACA;UACA;UACAkB;QACA;QACA;MACA;QACA;MACA;IACA;IACAW;MACAnD;IACA;IACA;AACA;AACA;AACA;IACAoD;MACApD;MACA;IACA;IACAqD;MACArD;IACA;IACA;AACA;AACA;AACA;IACAsD;MACA;IAAA,CACA;IACA;AACA;AACA;AACA;IACAC;MACA;IAAA;EAEA;AACA;AAAA,2B","file":"pages/devOps/devOps.js","sourcesContent":["import mod from \"-!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./devOps.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./devOps.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1689571872789\n      var cssReload = require(\"E:/HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/devOps/devOps.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./devOps.vue?vue&type=template&id=db2969b4&\"\nvar renderjs\nimport script from \"./devOps.vue?vue&type=script&lang=js&\"\nexport * from \"./devOps.vue?vue&type=script&lang=js&\"\nimport style0 from \"./devOps.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/devOps/devOps.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./devOps.vue?vue&type=template&id=db2969b4&\"","var components\ntry {\n  components = {\n    uniSearchBar: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar\" */ \"@/uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.vue\"\n      )\n    },\n    uniIcons: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-icons/components/uni-icons/uni-icons\" */ \"@/uni_modules/uni-icons/components/uni-icons/uni-icons.vue\"\n      )\n    },\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"uni_modules/uni-popup/components/uni-popup/uni-popup\" */ \"@/uni_modules/uni-popup/components/uni-popup/uni-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.selectOrgans.length\n  var g1 = _vm.selectOrgans.length\n  var l0 = _vm.__map(_vm.devices, function (item, __i1__) {\n    var $orig = _vm.__get_orig(item)\n    var g2 =\n      _vm.showType == 2\n        ? item.installPicture != null && item.installPicture.length\n        : null\n    var g3 =\n      _vm.showType == 2\n        ? item.installPicture != null && item.installPicture.length\n        : null\n    var g4 = _vm.showType == 2 && g3 ? item.installPicture.length : null\n    var g5 =\n      _vm.showType == 2\n        ? item.installPicture != null && item.installPicture.length > 0\n        : null\n    var g6 = _vm.showType == 2 && g5 ? item.installPicture.length : null\n    return {\n      $orig: $orig,\n      g2: g2,\n      g3: g3,\n      g4: g4,\n      g5: g5,\n      g6: g6,\n    }\n  })\n  var g7 = _vm.showType == 2 && _vm.devices.length <= 0\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        l0: l0,\n        g7: g7,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./devOps.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX.3.1.18.20210609.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./devOps.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"wrap\" @touchstart=\"touchStart\" @touchend=\"touchEnd\">\r\n\t\t<HeaderTabBar @onActive=\"tabbarToggle\"></HeaderTabBar>\r\n\t\t<view class=\"content\">\r\n\t\t\t<view class=\"search-bar\" v-if=\"!selectOrgans.length\">\r\n\t\t\t\t<uni-search-bar placeholder=\"搜索\" radius=\"100\" bgColor=\"#ecedef\" cancelButton=\"none\"\r\n\t\t\t\t\tv-model=\"searchValue\" @blur=\"blur\" @focus=\"focus\" @input=\"input\" @clear=\"clear\" @confirm=\"search\" />\r\n\t\t\t</view>\r\n\t\t\t<!-- 面包屑导航 -->\r\n\t\t\t<SlidingBreadcrumbs v-if=\"selectOrgans.length\" :selectOrgans=\"selectOrgans\" @onOrgansId=\"getOrgansId\" />\r\n\t\t\t<!-- 数据列表 -->\r\n\t\t\t<scroll-view class=\"organ-content\" scroll-y=\"true\">\r\n\t\t\t\t<view v-if=\"showType == 1\" class=\"organ-item\" v-for=\"item in organs\" @tap=\"getChildren(item)\">\r\n\t\t\t\t\t<view class=\"organ-item__content\">\r\n\t\t\t\t\t\t<view class=\"organ-name\">\r\n\t\t\t\t\t\t\t<text>{{item.name}}</text>\r\n\t\t\t\t\t\t\t<text>（{{item.deviceDefend}}/{{item.devices}}）</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<image v-if=\"item.children != 0\" class=\"right-image\" src=\"@/static/right_1.png\"\r\n\t\t\t\t\t\t\tmode=\"aspectFill\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-if=\"showType == 2\" class=\"organ-item\" v-for=\"item in devices\"\r\n\t\t\t\t\t@tap=\"onUnfold(item.id, item.installPicture)\">\r\n\t\t\t\t\t<view class=\"organ-item__content\">\r\n\t\t\t\t\t\t<view class=\"organ-name\">\r\n\t\t\t\t\t\t\t<text class=\"organ-name__text\">{{item.shortName}}</text>\r\n\t\t\t\t\t\t\t<uni-icons v-if=\"item.installPicture!=null && item.installPicture.length\"\r\n\t\t\t\t\t\t\t\ttype=\"checkmarkempty\" color=\"#9f4b63\"></uni-icons>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"right-operate\">\r\n\t\t\t\t\t\t\t<view class=\"photo-num-show\" v-if=\"item.installPicture!=null && item.installPicture.length\">\r\n\t\t\t\t\t\t\t\t<text class=\"photo-num\">\r\n\t\t\t\t\t\t\t\t\t{{item.installPicture.length}}张\r\n\t\t\t\t\t\t\t\t</text>\r\n\t\t\t\t\t\t\t\t<image :class=\"['right-image', deviceId==item.id?'down-image':'']\"\r\n\t\t\t\t\t\t\t\t\tsrc=\"@/static/right_1.png\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<view class=\"add-button\" v-else @tap.stop=\"onAddPhoto(item.id, item.installPicture)\">\r\n\t\t\t\t\t\t\t\t<image class=\"add-image\" src=\"@/static/add.png\" mode=\"aspectFill\"></image>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view :class=\"['photo-content',deviceId==item.id?'photo-content__unfold':'']\"\r\n\t\t\t\t\t\tv-if=\"item.installPicture!=null&&item.installPicture.length>0\">\r\n\t\t\t\t\t\t<DeviceImage v-for=\"(img, index) in item.installPicture\" :index=\"index\"\r\n\t\t\t\t\t\t\t:installPicture=\"item.installPicture\" :url=\"file_url+img.url\" :deviceId=\"item.id\"\r\n\t\t\t\t\t\t\t@onPreview=\"onPhotoPreview\" @onDialog=\"openDeleteDialog\" />\r\n\t\t\t\t\t\t<view v-if=\"item.installPicture.length < 3\" class=\"add-photo__wrap\"\r\n\t\t\t\t\t\t\t@tap.stop=\"onAddPhoto(item.id, item.installPicture)\">\r\n\t\t\t\t\t\t\t<image class=\"add-photo\" src=\"@/static/add_photo.png\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"no-data\" v-if=\"showType == 2 && devices.length <= 0\">\r\n\t\t\t\t\t<text>暂无设备!</text>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t\t<!-- 底部 -->\r\n\t\t<Footer />\r\n\t\t<!-- 弹窗 -->\r\n\t\t<uni-popup ref=\"popup\" type=\"share\">\r\n\t\t\t<view class=\"popup-wrap\">\r\n\t\t\t\t<view class=\"popup-button popup-photograph\" @tap=\"onPopupPhotograph('camera')\">\r\n\t\t\t\t\t<text class=\"popup-title\">拍照</text>\r\n\t\t\t\t\t<text class=\"popup-tips\">请横置拍照</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"popup-button popup-photo-album\" @tap=\"onPopupPhotograph('album')\">\r\n\t\t\t\t\t<text class=\"popup-title\">相册</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"popup-button popup-cancel\" @tap=\"onClose\">\r\n\t\t\t\t\t<text class=\"popup-title\">取消</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t\t<DialogTips ref=\"deletepopup\" content=\"是否要删除照片？\" @onConfirm=\"dialogConfirm\" />\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t// 调用组织机构树 设备类型树\r\n\r\n\timport HeaderTabBar from '@/components/HeaderTabBar.vue';\r\n\timport Footer from \"@/components/Footer.vue\";\r\n\timport SlidingBreadcrumbs from '@/components/SlidingBreadcrumbs.vue';\r\n\timport DialogTips from '@/components/DialogTips.vue';\r\n\timport DeviceImage from '@/components/DeviceImage.vue';\r\n\timport moment from 'moment';\r\n\timport lodash from 'lodash';\r\n\timport {\r\n\t\tmapGetters\r\n\t} from 'vuex';\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tHeaderTabBar,\r\n\t\t\tSlidingBreadcrumbs,\r\n\t\t\tFooter,\r\n\t\t\tDialogTips,\r\n\t\t\tDeviceImage\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttabbarId: 0,\r\n\t\t\t\torgans: [],\r\n\t\t\t\tdevices: [],\r\n\t\t\t\tselectOrgans: [],\r\n\t\t\t\torganId: '',\r\n\t\t\t\torganName: '',\r\n\t\t\t\tparentId: '',\r\n\t\t\t\tshowType: 1, // 显示类型 1 机构 2 设备\r\n\t\t\t\tfile_url: uni.getStorageSync('file_url'),\r\n\t\t\t\tdeviceId: -1, // 当前需要删除图片的设备iD\r\n\t\t\t\tinstallPicture: [], // 当前需要上传的图片\r\n\t\t\t\tapiUrl: '/v3/dms/device?tree=4',\r\n\t\t\t\toptions: {},\r\n\t\t\t\tsearchValue: '',\r\n\t\t\t\tcurrentCount: 0,\r\n\t\t\t\tdeviceTypeId: -1\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapGetters({\r\n\t\t\t\tisTokenValid: 'user/isTokenValid',\r\n\t\t\t})\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tif (this.isTokenValid) {\r\n\t\t\t\tthis.file_url = uni.getStorageSync('file_url');\r\n\t\t\t\tconsole.log(this.file_url)\r\n\t\t\t\tthis.getOrganTree();\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBackPress(event) {\r\n\t\t\tif (event.from === 'backbutton') {\r\n\t\t\t\tlet id = 0,\r\n\t\t\t\t\tlength = this.selectOrgans.length,\r\n\t\t\t\t\tisback = true;\r\n\t\t\t\tif (length === 0) {\r\n\t\t\t\t\tisback = false;\r\n\t\t\t\t} else if (length === 1) {\r\n\t\t\t\t\tid = this.selectOrgans[0].id;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tid = this.selectOrgans[length - 2].id;\r\n\t\t\t\t}\r\n\t\t\t\tthis.searchValue = '';\r\n\t\t\t\tthis.getOrgansId(id);\r\n\t\t\t\treturn isback;\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * 标签切换回调返回选中的标签\r\n\t\t\t * @param {Object} val\r\n\t\t\t */\r\n\t\t\ttabbarToggle(val) {\r\n\t\t\t\tif (this.tabbarId == val) return;\r\n\t\t\t\tthis.searchValue = '';\r\n\t\t\t\tthis.tabbarId = val;\r\n\t\t\t\tthis.apiUrl = val === 0 ? '/v3/dms/device?tree=4' : '/v3/dms/device?tree=5';\r\n\t\t\t\tthis.selectOrgans = [];\r\n\t\t\t\tthis.getOrganTree();\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 获取组织结构\r\n\t\t\t * @param {Object} parentId\r\n\t\t\t */\r\n\t\t\tgetOrganTree(parentId) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\ttitle: '努力加载中...'\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(this.apiUrl, '123')\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tthis.$request(this.apiUrl, {\r\n\t\t\t\t\t\tparentId\r\n\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = res.data\r\n\t\t\t\t\t\tconsole.log('chx', JSON.stringify(data).includes('安防设备'))\r\n\t\t\t\t\t\tthis.deviceId = -1;\r\n\t\t\t\t\t\tthis.deviceTypeId = -1;\r\n\t\t\t\t\t\tthis.showType = 1;\r\n\t\t\t\t\t\tthis.organs = data;\r\n\t\t\t\t\t\tresolve(true);\r\n\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t}).catch(error => {\r\n\t\t\t\t\t\tconsole.log(error)\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\tthis.$utils.toast('未知错误!');\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 获取设备\r\n\t\t\t * @param {Object} options\r\n\t\t\t * type 0-全部设备，1-监控视频，2-图像火灾设备，3-人脸识别设备\r\n\t\t\t * organId 节点id\r\n\t\t\t * organType 节点类型，0-组织结构，1-设备类型\r\n\t\t\t */\r\n\t\t\tgetDevice(options) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\ttitle: '努力加载中...'\r\n\t\t\t\t})\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tthis.$request('/v3/dms/device', options).then(res => {\r\n\t\t\t\t\t\t// console.log(res)\r\n\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = res;\r\n\t\t\t\t\t\tif (data.code === 200) {\r\n\t\t\t\t\t\t\tconsole.log('设备', data)\r\n\t\t\t\t\t\t\tif (this.tabbarId === 1 || this.searchValue) {\r\n\t\t\t\t\t\t\t\tthis.showType = 2;\r\n\t\t\t\t\t\t\t\tthis.devices = data.data;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.showType = 1;\r\n\t\t\t\t\t\t\t\tthis.handleGrouping(data.data)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresolve(true);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$utils.toast(data.errInfo.msg);\r\n\t\t\t\t\t\t\tresolve(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t}).catch(error => {\r\n\t\t\t\t\t\tconsole.log(error)\r\n\t\t\t\t\t\treject(error)\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\tthis.$utils.toast('未知错误!');\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 显示设备\r\n\t\t\t * @param {Object} deviceTypeId\r\n\t\t\t */\r\n\t\t\tshowDevice(deviceTypeId) {\r\n\t\t\t\tthis.showType = 2;\r\n\t\t\t\tthis.organs.forEach(item => {\r\n\t\t\t\t\tif (item.deviceTypeId === deviceTypeId) {\r\n\t\t\t\t\t\tthis.devices = item.childrens;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 处理设备类型分组\r\n\t\t\t * @param {Object} data\r\n\t\t\t */\r\n\t\t\thandleGrouping(data) {\r\n\t\t\t\tthis.organs = [];\r\n\t\t\t\tdata.forEach((item) => {\r\n\t\t\t\t\tlet deviceFilter = data.filter(\r\n\t\t\t\t\t\t(el) => el.deviceTypeId === item.deviceTypeId\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (this.organs.length === 0) {\r\n\t\t\t\t\t\tlet deviceDefend = deviceFilter.filter(el => el.installPicture !== null);\r\n\t\t\t\t\t\tthis.organs.push({\r\n\t\t\t\t\t\t\tid: item.deviceTypeId,\r\n\t\t\t\t\t\t\tdeviceTypeId: item.deviceTypeId,\r\n\t\t\t\t\t\t\tname: item.deviceTypeName,\r\n\t\t\t\t\t\t\tchildren: deviceFilter.length,\r\n\t\t\t\t\t\t\tdevices: deviceFilter.length,\r\n\t\t\t\t\t\t\tdeviceDefend: deviceDefend.length,\r\n\t\t\t\t\t\t\tchildrens: deviceFilter\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet isDeviceType = this.organs.some((el) => el.deviceTypeId === item.deviceTypeId);\r\n\t\t\t\t\t\tif (!isDeviceType) {\r\n\t\t\t\t\t\t\tlet deviceDefend = deviceFilter.filter(el => el.installPicture !== null);\r\n\t\t\t\t\t\t\tthis.organs.push({\r\n\t\t\t\t\t\t\t\tid: item.deviceTypeId,\r\n\t\t\t\t\t\t\t\tdeviceTypeId: item.deviceTypeId,\r\n\t\t\t\t\t\t\t\tname: item.deviceTypeName,\r\n\t\t\t\t\t\t\t\tchildren: deviceFilter.length,\r\n\t\t\t\t\t\t\t\tdevices: deviceFilter.length,\r\n\t\t\t\t\t\t\t\tdeviceDefend: deviceDefend.length,\r\n\t\t\t\t\t\t\t\tchildrens: deviceFilter\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif (this.deviceTypeId !== -1) this.showDevice(this.deviceTypeId);\r\n\t\t\t\t// console.log('处理设备类型分组', this.organs);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 面包屑回调\r\n\t\t\t * @param {Object} id\r\n\t\t\t */\r\n\t\t\tgetOrgansId(id) {\r\n\t\t\t\tlet selectOrgans = this.selectOrgans;\r\n\t\t\t\tlet isDevice = selectOrgans.some(item => item.id == id && item.children <= 0);\r\n\t\t\t\tlet index = selectOrgans.findIndex(item => item.id == id);\r\n\t\t\t\tthis.deviceTypeId = -1;\r\n\t\t\t\tif (index !== 0) {\r\n\t\t\t\t\tthis.selectOrgans.splice(index + 1, selectOrgans.length - 1);\r\n\t\t\t\t\tif (isDevice) {\r\n\t\t\t\t\t\tlet options = {\r\n\t\t\t\t\t\t\ttype: 0,\r\n\t\t\t\t\t\t\torganId: id,\r\n\t\t\t\t\t\t\torganType: this.tabbarId\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.getDevice(options);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.getOrganTree(id);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.selectOrgans.splice(index, selectOrgans.length);\r\n\t\t\t\t\tthis.getOrganTree();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 查询下一级\r\n\t\t\t * @param {Object} data\r\n\t\t\t */\r\n\t\t\tasync getChildren(data) {\r\n\t\t\t\t// console.log('查询下一级', data)\r\n\t\t\t\tif (data.childrens !== undefined) {\r\n\t\t\t\t\tthis.deviceTypeId = data.deviceTypeId;\r\n\t\t\t\t\tthis.showDevice(data.deviceTypeId);\r\n\t\t\t\t\tthis.selectOrgans.push({\r\n\t\t\t\t\t\t\"id\": data.id,\r\n\t\t\t\t\t\t\"deviceTypeId\": data.deviceTypeId,\r\n\t\t\t\t\t\t\"name\": data.name,\r\n\t\t\t\t\t\t\"children\": data.children,\r\n\t\t\t\t\t\t\"devices\": data.devices,\r\n\t\t\t\t\t\t\"deviceDefend\": data.deviceDefend,\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.deviceTypeId = -1;\r\n\t\t\t\t\tlet result = false;\r\n\t\t\t\t\tif (data.children !== 0) {\r\n\t\t\t\t\t\tresult = await this.getOrganTree(data.id);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlet options = {\r\n\t\t\t\t\t\t\ttype: 0,\r\n\t\t\t\t\t\t\torganId: data.id,\r\n\t\t\t\t\t\t\torganType: this.tabbarId\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.organId = data.id;\r\n\t\t\t\t\t\tresult = await this.getDevice(options)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (result) this.selectOrgans.push(data);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 选择照片\r\n\t\t\t * @param {Object} sourceType\r\n\t\t\t */\r\n\t\t\tonPopupPhotograph(sourceType) {\r\n\t\t\t\tlet count = 3 - this.currentCount;\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: count,\r\n\t\t\t\t\tsizeType: ['compressed'], // 原图'original'\r\n\t\t\t\t\tsourceType: [sourceType], // 从相册选择\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tthis.onClose();\r\n\t\t\t\t\t\tthis.onPhotoUpload(res.tempFilePaths);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (error) => {\r\n\t\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 从相册选择图片\r\n\t\t\t */\r\n\t\t\tselectGalleryPick() {\r\n\t\t\t\tplus.gallery.pick((e) => {\r\n\t\t\t\t\tthis.onPhotoUpload(e.files)\r\n\t\t\t\t}, (e) => {\r\n\t\t\t\t\tconsole.log(\"取消选择图片\");\r\n\t\t\t\t}, {\r\n\t\t\t\t\tfilter: \"image\",\r\n\t\t\t\t\tmultiple: true,\r\n\t\t\t\t\tmaximum: 3\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 照片上传\r\n\t\t\t * @param {Object} data\r\n\t\t\t */\r\n\t\t\tasync onPhotoUpload(data) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\ttitle: '上传中...'\r\n\t\t\t\t})\r\n\t\t\t\tlet options = {\r\n\t\t\t\t\t\"deviceId\": this.deviceId,\r\n\t\t\t\t\t\"installPicture\": [],\r\n\t\t\t\t}\r\n\t\t\t\tif (this.installPicture !== null) {\r\n\t\t\t\t\tthis.installPicture.forEach(\r\n\t\t\t\t\t\timg => {\r\n\t\t\t\t\t\t\toptions.installPicture.push({\r\n\t\t\t\t\t\t\t\t\"name\": img.name,\r\n\t\t\t\t\t\t\t\t\"url\": img.url,\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tfor (let item of data) {\r\n\t\t\t\t\tlet result = await this.$utils.uploadFile(item);\r\n\t\t\t\t\tif (result.code === 'success') {\r\n\t\t\t\t\t\toptions.installPicture.push({\r\n\t\t\t\t\t\t\t\"name\": moment().format(\r\n\t\t\t\t\t\t\t\t'YYYY-MM-DD HH:mm:ss'\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\"url\": result.url\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log('失败')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tawait this.onDeviceDefend(options);\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tthis.$utils.toast('上传成功!');\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 关联图片到设备\r\n\t\t\t * @param {Object} options\r\n\t\t\t */\r\n\t\t\tonDeviceDefend(options) {\r\n\t\t\t\tconsole.log('关联图片到设备', options)\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tthis.$request('/v2/device/defend', options, 'POST').then(res => {\r\n\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = res;\r\n\t\t\t\t\t\tif (data.code === 200) {\r\n\t\t\t\t\t\t\tlet options = {\r\n\t\t\t\t\t\t\t\ttype: 0,\r\n\t\t\t\t\t\t\t\torganId: this.organId,\r\n\t\t\t\t\t\t\t\torganType: this.tabbarId,\r\n\t\t\t\t\t\t\t\tkeyword: this.searchValue\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.getDevice(options);\r\n\t\t\t\t\t\t\tresolve(true);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$utils.toast(data.errInfo.msg);\r\n\t\t\t\t\t\t\tresolve(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).catch(error => {\r\n\t\t\t\t\t\tconsole.log(error)\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t\tthis.$utils.toast('未知错误!');\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 图片预览\r\n\t\t\t * @param {Object} imgPaths\r\n\t\t\t */\r\n\t\t\tonPhotoPreview(imgPaths, current) {\r\n\t\t\t\tlet imgs = imgPaths.map(item => this.file_url + item.url);\r\n\t\t\t\tthis.$utils.previewImg(imgs, current);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 展开\r\n\t\t\t * @param {Object} installPicture\r\n\t\t\t */\r\n\t\t\tonUnfold(id, installPicture) {\r\n\t\t\t\t// console.log(installPicture)\r\n\t\t\t\tif (installPicture === null || installPicture.length <= 0) return;\r\n\t\t\t\tif (this.deviceId === id) {\r\n\t\t\t\t\tthis.deviceId = -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.deviceId = id;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 删除dialog\r\n\t\t\t * @param {Object} id\r\n\t\t\t * @param {Object} data\r\n\t\t\t * @param {Object} index\r\n\t\t\t */\r\n\t\t\topenDeleteDialog(id, data, index) {\r\n\t\t\t\tthis.options = {\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tdata,\r\n\t\t\t\t\tindex\r\n\t\t\t\t}\r\n\t\t\t\tthis.deviceId = id;\r\n\t\t\t\tthis.$refs.deletepopup.dialogOpen();\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 确认删除\r\n\t\t\t */\r\n\t\t\tdialogConfirm() {\r\n\t\t\t\tthis.onDeletePhoto(this.options.id, this.options.data, this.options.index);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 图片删除\r\n\t\t\t * @param {Object} id\r\n\t\t\t * @param {Object} data\r\n\t\t\t * @param {Object} index\r\n\t\t\t */\r\n\t\t\tasync onDeletePhoto(id, data, index) {\r\n\t\t\t\tlet options = {\r\n\t\t\t\t\t\"deviceId\": id,\r\n\t\t\t\t\t\"installPicture\": [],\r\n\t\t\t\t}\r\n\t\t\t\tdata.splice(index, 1);\r\n\t\t\t\tdata.forEach(img => {\r\n\t\t\t\t\toptions.installPicture.push({\r\n\t\t\t\t\t\t\"name\": img.name,\r\n\t\t\t\t\t\t\"url\": img.url\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tlet res = await this.onDeviceDefend(options);\r\n\t\t\t\tif (res) {\r\n\t\t\t\t\tthis.$utils.toast('删除成功!');\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(this.deviceId)\r\n\t\t\t\tthis.$refs.deletepopup.dialogClose();\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 添加照片\r\n\t\t\t * @param {Object} id\r\n\t\t\t * @param {Object} data\r\n\t\t\t */\r\n\t\t\tonAddPhoto(id, data) {\r\n\t\t\t\tconsole.log(id, data)\r\n\t\t\t\tthis.$refs.popup.open();\r\n\t\t\t\tthis.deviceId = id;\r\n\t\t\t\tthis.currentCount = data === null ? 0 : data.length;\r\n\t\t\t\tthis.installPicture = data;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 关闭选择图片popup\r\n\t\t\t */\r\n\t\t\tonClose() {\r\n\t\t\t\tthis.$refs.popup.close();\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 键盘搜索触发\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tsearch(e) {\r\n\t\t\t\tif (e.value === '') return;\r\n\t\t\t\tlet options = {\r\n\t\t\t\t\ttype: 0,\r\n\t\t\t\t\t// organId: 0,\r\n\t\t\t\t\t// organType: this.tabbarId,\r\n\t\t\t\t\tkeyword: e.value\r\n\t\t\t\t}\r\n\t\t\t\tthis.getDevice(options);\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 输入类容触发\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tinput: lodash.debounce(function(e) {\r\n\t\t\t\tif (e !== \"\") {\r\n\t\t\t\t\tlet options = {\r\n\t\t\t\t\t\ttype: 0,\r\n\t\t\t\t\t\t// organId: 0,\r\n\t\t\t\t\t\t// organType: this.tabbarId,\r\n\t\t\t\t\t\tkeyword: e\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.getDevice(options);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.getOrganTree();\r\n\t\t\t\t}\r\n\t\t\t}, 1000),\r\n\t\t\tblur(e) {\r\n\t\t\t\tconsole.log('blur', e)\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 清除\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\tclear(e) {\r\n\t\t\t\tconsole.log('clear', e)\r\n\t\t\t\tthis.getOrganTree();\r\n\t\t\t},\r\n\t\t\tfocus(e) {\r\n\t\t\t\tconsole.log('focus', e)\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 触摸开始\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\ttouchStart(e) {\r\n\t\t\t\t// console.log(e)\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 触摸结束\r\n\t\t\t * @param {Object} e\r\n\t\t\t */\r\n\t\t\ttouchEnd(e) {\r\n\t\t\t\t// console.log(e)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.wrap {\r\n\t\theight: 100vh;\r\n\t\toverflow: hidden;\r\n\r\n\t\t.content {\r\n\t\t\tmargin-top: 15rpx;\r\n\t\t\tbackground-color: #FFFFFF;\r\n\t\t\toverflow: hidden;\r\n\r\n\t\t\t.search-bar {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tz-index: 9;\r\n\r\n\t\t\t\t.placeholder {\r\n\t\t\t\t\tmargin-left: 27rpx;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tcolor: #959aa0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t// 机构\r\n\t.organ-content {\r\n\t\twidth: 100%;\r\n\t\tborder-top: solid 1rpx #e5e5e5;\r\n\t\tposition: absolute;\r\n\t\ttop: calc(var(--status-bar-height) + 220rpx);\r\n\t\tbottom: 0;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tmargin-bottom: 152rpx;\r\n\r\n\t\t.organ-item {\r\n\t\t\tmargin-left: 30rpx;\r\n\t\t\tborder-bottom: solid 1px #e5e5e5;\r\n\r\n\t\t\t&:last-child {\r\n\t\t\t\t// border-bottom: none;\r\n\t\t\t}\r\n\r\n\t\t\t.organ-name {\r\n\t\t\t\tfont-size: 34rpx;\r\n\t\t\t\tcolor: #000000;\r\n\t\t\t}\r\n\r\n\t\t\t.organ-name__text {\r\n\t\t\t\tmargin-right: 15rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.organ-item__content {\r\n\t\t\theight: 95rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\tpadding-right: 30rpx;\r\n\r\n\t\t\t.right-operate {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\r\n\t\t\t\t.photo-num-show {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.photo-num {\r\n\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\tcolor: #878787;\r\n\t\t\t\t\tmargin-right: 10rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.down-image {\r\n\t\t\t\t\ttransform: rotate(90deg);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.photo-content {\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\theight: 0;\r\n\t\t\toverflow: hidden;\r\n\t\t\ttransition: all 0.3s;\r\n\t\t}\r\n\r\n\t\t.photo-content__unfold {\r\n\t\t\theight: auto;\r\n\t\t\tmargin: 20rpx 0;\r\n\t\t\ttransition: all 0.3s;\r\n\t\t}\r\n\t}\r\n\r\n\t.popup-wrap {\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 10rpx 10rpx 0 0;\r\n\r\n\t\t.popup-button {\r\n\t\t\theight: 114rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: center;\r\n\t\t\tborder-bottom: 1px solid #e5e5e5;\r\n\t\t}\r\n\r\n\t\t.popup-photograph {\r\n\t\t\tflex-direction: column;\r\n\t\t}\r\n\r\n\t\t.popup-photo-album {}\r\n\r\n\t\t.popup-cancel {\r\n\t\t\tborder-bottom: none;\r\n\t\t\tborder-top: 16rpx solid #f2f4f5;\r\n\t\t}\r\n\r\n\t\t.popup-title {\r\n\t\t\tfont-size: 36rpx;\r\n\t\t\tcolor: #333333;\r\n\t\t}\r\n\r\n\t\t.popup-tips {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #999999;\r\n\t\t}\r\n\t}\r\n\r\n\t.no-data {\r\n\t\theight: 200rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tcolor: #999999;\r\n\t}\r\n</style>\n"],"sourceRoot":""}